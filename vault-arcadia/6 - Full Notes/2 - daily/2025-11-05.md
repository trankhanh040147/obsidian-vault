- **NhÃ¢n sá»±**: *Kenny*
* **Viá»‡c Ä‘Ã£ thá»±c hiá»‡n**:    	
	- [Invite Link] Check API vÃ  cáº­p nháº­t document
	- [Conversation] Kiá»ƒm tra tÃ­nh nÄƒng Tab, cáº­p nháº­t validate alias cá»§a tab
	- [TLA] API list translate options (done)
* **Viá»‡c hÃ´m nay**:
	- [ComGroup WS] Check bug thiáº¿u tin offline khi pin - cáº­p nháº­t handle cÃ¡c CMD Pin
	- [Stask] Fix bug sá»‘ lÆ°á»£ng subtask tá»‘i Ä‘a 
- **KhÃ³ khÄƒn**:
- [ ] stask code generator
---
#tech 
- [ ] [account suspended from github](https://www.youtube.com/watch?v=7gCCXCSs734) 
- [ ] [[Soft Delete]]
	- [ ] [[Kiáº¿n trÃºc hÆ°á»›ng sá»± kiá»‡n (Event-Driven Architecture)]]
- [ ] [[Bulk Download]]
- [ ] CDC
	- [ ] CDC in MongoDB 
	- [ ] Build CDC tracker
- [ ] Microservice vs Distributed Monolith
---
#tool
- [x] Try 1 **Desktop Environment (DE)**
- [x] Optimize Gnome Performance
- [ ] Gnome Extensions

---
```bash
/usr/local/go/bin/go test -c -o /home/vessel/.cache/JetBrains/GoLand2025.1/tmp/GoLand/___2go_test_test_testkit.test test/testkit #gosetup &&
/usr/local/go/bin/go tool test2json -t /home/vessel/.cache/JetBrains/GoLand2025.1/tmp/GoLand/___2go_test_test_testkit.test -test.v=test2json -test.paniconexit0 #gosetup
```

---
```
Based on your logs, here's the workflow for how `GetConfig()` is being called and why your tests failed and then succeeded.

### ğŸ•µï¸ How `GetConfig()` is Called

It's not your tests (like `TestResponseWrapper_New`) that are calling `GetConfig()` directly. It's being called **during the Go runtime's package initialization**, _before_ any tests even start.

Here's the step-by-step flow:

1. Test Execution: You run the compiled test binary:
    
    /usr/local/go/bin/go tool test2json -t .../___2go_test_test_testkit.test ...
    
2. **Package Loading:** The Go runtime loads the `test/testkit` package and all of its dependencies (any package it imports, and any package _they_ import, and so on).
    
3. **Global Variable Initialization:** As the runtime loads each package, it initializes any package-level (global) variables.
    
4. **The Trigger:** Your `rgrep` output shows _exactly_ where the calls are:
    
    Bash
    
    ```
    handlers_test/base_test.go:var cfg = configure.GetConfig()
    pkg/utils/utils.go:Â  Â  Â cfg = configure.GetConfig()
    pkg/token/service.go:Â  Â cfgÂ  Â  = configure.GetConfig()
    pkg/token/base.go:Â  Â  Â  Â  Â  Â  Â  cfg:Â  Â  Â  Â  Â  Â  Â configure.GetConfig(),
    ```
    
    Your `test/testkit` package almost certainly imports one of these other packages (like `pkg/utils` or `pkg/token`). The moment it's imported, its global `cfg` variable is initialized, which **triggers the `configure.GetConfig()` call**.
    
5. **`GetConfig()` Runs:**
    
    - The `GetConfig()` function starts.
        
    - It immediately prints `"Get config"`, which you see in your successful log.
        
    - It then calls `godotenv.Load()` and `env.Parse(config)`.
        

---

### â“ Why It Failed the First Time (and Passed the Second)

The problem is all about the **Current Working Directory (PWD)** and **relative file paths**.

The `GetConfig()` function looks for a file specified by the `EMAIL_TEMPLATE_PATH` variable, and if that's not set, it defaults to `tmp/template`.

`envDefault:"tmp/template"`

This is a **relative path**. The system looks for it _relative to where you ran the command_.

#### Run 1: Failure ğŸ‘

- **Your PWD:** `/media/veracrypt1/src/sigpro-admin-tenant-api`
    
- **What `GetConfig()` does:** It looks for the file at `<PWD>/tmp/template`.
    
- **The path it tried to open:** `/media/veracrypt1/src/sigpro-admin-tenant-api/tmp/template`
    
- **The Error:** `open tmp/template: no such file or directory`. The program couldn't find the file at that location, so it failed with a fatal error.
    

#### Run 2: Success ğŸ‘

- **Your PWD:** `/media/veracrypt1/src/sigpro-admin-tenant-api/tmp/test` (because you ran `z tmp/test`)
    
- **What `GetConfig()` does:**
    
    1. It calls `godotenv.Load()`, which now looks for a `.env` file inside `/media/veracrypt1/src/sigpro-admin-tenant-api/tmp/test`.
        
    2. It's highly likely you have a **`.env` file in that `tmp/test` directory** that correctly sets the `EMAIL_TEMPLATE_PATH` variable (e.g., `EMAIL_TEMPLATE_PATH=../tmp/template`).
        
    3. Because `EMAIL_TEMPLATE_PATH` is now set correctly (from that `.env` file), `env.Parse()` successfully loads the file from the _correct_ path. It no longer uses the broken `envDefault`.
        
- **The Result:** The config loads, the global variables are set, and your tests proceed to run.
    

**In short:** Your test setup relies on a specific `.env` file located in `tmp/test` to set the correct paths for your configuration. Running the test from the project root (`sigpro-admin-tenant-api`) doesn't load this file, causing the configuration to fail.

This is a common setup for Go tests, where the IDE (GoLand) is configured to automatically set the working directory to a specific test folder (like `tmp/test`) that contains test-specific environment files.

Would you like me to show you how to configure the "Run/Debug Configuration" in GoLand to always use the correct working directory?
```